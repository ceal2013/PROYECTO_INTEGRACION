{% extends 'base_layout.html' %}

{% block content %}

{% if request.session.rol == 'Jefe de Ventas' %}
<div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="card-title">Dashboard (Jefe de Ventas)</h2>
    <h4 class="text-muted">Hoy: {% now "d/m/Y" %}</h4>
</div>
<div class="row">
    <div class="col-md-6">
        <div class="card {% if control_hoy.estado == 'Abierto' %}border-success{% else %}border-danger{% endif %} mb-3">
            <div class="card-header">
                <h5>Estado del Día</h5>
            </div>
            <div class="card-body text-center">
                {% if control_hoy.estado == 'Abierto' %}
                    <h1 class="display-4 text-success">ABIERTO</h1>
                    <a href="{% url 'control_dia' %}" class="btn btn-danger">Cerrar Día</a>
                {% else %}
                    <h1 class="display-4 text-danger">CERRADO</h1>
                    <a href="{% url 'control_dia' %}" class="btn btn-success">Abrir Día</a>
                {% endif %}
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="card text-white bg-success mb-3">
            <div class="card-header">
                <h5>Total Recaudado Hoy</h5>
            </div>
            <div class="card-body text-center">
                <h1 class="display-4 text-white">${{ total_recaudado_hoy|floatformat:0 }}</h1>
                <a href="{% url 'reporte_diario' %}" class="btn btn-outline-light">Ver Reporte Completo</a>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-md-4">
        <div class="card text-center">
            <div class="card-body">
                <i class="bi bi-box-seam" style="font-size: 3rem; color: #198754;"></i>
                <h5 class="card-title mt-3">Gestión de Productos</h5>
                <p class="card-text">Añadir, editar y eliminar productos del inventario.</p>
                <a href="{% url 'listar_productos' %}" class="btn btn-primary">Ir a Productos</a>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card text-center">
            <div class="card-body">
                <i class="bi bi-people-fill" style="font-size: 3rem; color: #198754;"></i>
                <h5 class="card-title mt-3">Gestión de Usuarios</h5>
                <p class="card-text">Crear y administrar cuentas de vendedores.</p>
                <a href="{% url 'listar_usuarios' %}" class="btn btn-primary">Ir a Usuarios</a>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card text-center">
            <div class="card-body">
                <i class="bi bi-cart-plus" style="font-size: 3rem; color: #198754;"></i>
                <h5 class="card-title mt-3">Punto de Venta</h5>
                <p class="card-text">Acceder al módulo para registrar una nueva venta.</p>
                <a href="{% url 'crear_venta' %}" class="btn btn-primary">Ir a Ventas</a>
            </div>
        </div>
    </div>
</div>

{% else %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card text-center p-4">
            <h3 class="card-title">Bienvenido, {{ request.session.username }}</h3>
            <p class="lead">Si el día está abierto, serás redirigido al módulo de ventas automáticamente.</p>
            <p class="mt-3">Si el día está cerrado, por favor contacta al Jefe de Ventas para iniciar la jornada.</p>
        </div>
    </div>
</div>
{% endif %}

{% endblock %}
